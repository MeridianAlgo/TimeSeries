2025-08-15 22:27:05,192 - stock_predictor - INFO - Logging initialized. Log file: logs/stock_predictor_20250815_222705.log
2025-08-15 22:27:05,198 - stock_predictor.models.hyperparameters - INFO - Hyperparameters loaded for arima
2025-08-15 22:27:05,203 - stock_predictor.models.hyperparameters - INFO - Hyperparameters loaded for lstm
2025-08-15 22:27:05,208 - stock_predictor.models.hyperparameters - INFO - Hyperparameters loaded for random_forest
2025-08-15 22:27:05,208 - stock_predictor - INFO - Stock Predictor Application initialized
2025-08-15 22:27:05,208 - stock_predictor - INFO - Starting full pipeline for AAPL
2025-08-15 22:27:05,209 - stock_predictor - INFO - Fetching data for AAPL
2025-08-15 22:27:05,209 - stock_predictor.data.fetcher - INFO - Fetching data for AAPL from 2020-08-13 to 2025-08-12
2025-08-15 22:27:07,031 - stock_predictor.data.fetcher - INFO - Successfully fetched 1254 records for AAPL
2025-08-15 22:27:07,031 - stock_predictor - INFO - Preprocessing data
2025-08-15 22:27:07,031 - stock_predictor.data.preprocessor - INFO - Handling missing values
2025-08-15 22:27:07,033 - stock_predictor.data.preprocessor - INFO - Handling outliers using method: cap
2025-08-15 22:27:07,035 - stock_predictor - INFO - Engineering features
2025-08-15 22:27:07,035 - stock_predictor.data.feature_engineer - INFO - Engineering all features
2025-08-15 22:27:07,035 - stock_predictor.data.feature_engineer - INFO - Creating moving averages with windows: [5, 10, 20]
2025-08-15 22:27:07,037 - stock_predictor.data.feature_engineer - INFO - Calculating volatility with window: 20
2025-08-15 22:27:07,038 - stock_predictor.data.feature_engineer - INFO - Creating lagged features with lags: [1, 2, 3]
2025-08-15 22:27:07,040 - stock_predictor.data.feature_engineer - INFO - Creating technical indicators
2025-08-15 22:27:07,046 - stock_predictor.data.feature_engineer - INFO - Created 36 features
2025-08-15 22:27:07,046 - stock_predictor.data.feature_engineer - INFO - Creating target variable: next_close, horizon: 1
2025-08-15 22:27:07,048 - stock_predictor - INFO - Data preparation completed. Final dataset: 1233 samples, 46 features
2025-08-15 22:27:07,049 - stock_predictor - INFO - Data splits - Train: 863, Val: 185, Test: 185
2025-08-15 22:27:07,049 - stock_predictor - INFO - Starting model training
2025-08-15 22:27:07,049 - stock_predictor - INFO - Training arima model
2025-08-15 22:27:07,050 - stock_predictor.models.hyperparameters - INFO - Hyperparameters saved for arima
2025-08-15 22:27:07,050 - stock_predictor.models.arima - INFO - Updated hyperparameters for arima
2025-08-15 22:27:07,051 - stock_predictor.models.arima - INFO - Starting training for arima
2025-08-15 22:27:07,051 - stock_predictor.models.arima - INFO - Auto-selecting ARIMA order...
2025-08-15 22:27:07,051 - stock_predictor.models.arima - INFO - Starting auto ARIMA order selection
2025-08-15 22:27:08,972 - stock_predictor.models.arima - INFO - Best ARIMA order: (0, 1, 0), seasonal: None, AIC: 4094.90
2025-08-15 22:27:08,973 - stock_predictor.models.arima - ERROR - Training failed for arima: ARIMA model fitting failed: 'NoneType' object is not subscriptable
2025-08-15 22:27:08,973 - stock_predictor - ERROR - Failed to train arima: Training failed for arima: ARIMA model fitting failed: 'NoneType' object is not subscriptable
2025-08-15 22:27:08,973 - stock_predictor - INFO - Training lstm model
2025-08-15 22:27:08,974 - stock_predictor.models.hyperparameters - INFO - Hyperparameters saved for lstm
2025-08-15 22:27:08,974 - stock_predictor.models.lstm - INFO - Updated hyperparameters for lstm
2025-08-15 22:27:08,974 - stock_predictor.models.lstm - INFO - Starting training for lstm
2025-08-15 22:27:29,032 - stock_predictor.models.lstm - INFO - LSTM training completed. Final loss: 5400.514648
2025-08-15 22:27:29,032 - stock_predictor.models.lstm - INFO - Training completed for lstm in 20.06 seconds
2025-08-15 22:27:29,032 - stock_predictor - INFO - lstm training completed
2025-08-15 22:27:29,032 - stock_predictor - INFO - Training random_forest model
2025-08-15 22:27:29,033 - stock_predictor.models.hyperparameters - INFO - Hyperparameters saved for random_forest
2025-08-15 22:27:29,033 - stock_predictor.models.random_forest - INFO - Updated hyperparameters for random_forest
2025-08-15 22:27:29,034 - stock_predictor.models.random_forest - INFO - Starting training for random_forest
2025-08-15 22:27:29,148 - stock_predictor.models.random_forest - INFO - Random Forest training completed. Train RMSE: 1.684294
2025-08-15 22:27:29,148 - stock_predictor.models.random_forest - INFO - Validation RMSE: 24.835206
2025-08-15 22:27:29,149 - stock_predictor.models.random_forest - INFO - Training completed for random_forest in 0.11 seconds
2025-08-15 22:27:29,149 - stock_predictor - INFO - random_forest training completed
2025-08-15 22:27:29,149 - stock_predictor - INFO - Successfully trained 2 models
2025-08-15 22:27:29,149 - stock_predictor - INFO - Evaluating models
2025-08-15 22:27:29,467 - stock_predictor.evaluation.evaluator - INFO - Evaluation completed for lstm: RMSE=137.3404, MAE=136.1470, Dir_Acc=44.57%
2025-08-15 22:27:29,486 - stock_predictor.evaluation.evaluator - INFO - Evaluation completed for random_forest: RMSE=34.5824, MAE=30.3299, Dir_Acc=52.17%
2025-08-15 22:27:29,487 - stock_predictor.evaluation.evaluator - INFO - Model comparison completed for 2 models
2025-08-15 22:27:29,487 - stock_predictor - INFO - Model evaluation results:
2025-08-15 22:27:29,491 - stock_predictor - INFO - 
          mae        rmse           mse  directional_accuracy       mape   r2_score  correlation   max_error        bias  n_samples     model_name
1   30.329933   34.582373   1195.940555             52.173913  13.274342  -2.664403     0.532148   64.281835  -30.135778        185  random_forest
0  136.147024  137.340377  18862.379139             44.565217  61.639208 -56.794984          NaN  174.292290 -136.147024        185           lstm
2025-08-15 22:27:29,491 - stock_predictor - INFO - Building ensemble
2025-08-15 22:27:29,491 - stock_predictor.ensemble.builder - INFO - Added model 'random_forest' to ensemble
2025-08-15 22:27:29,492 - stock_predictor.ensemble.builder - INFO - Added model 'lstm' to ensemble
2025-08-15 22:27:29,492 - stock_predictor.ensemble.builder - INFO - Calculated weights using inverse_error: {'random_forest': 0.7988493472448569, 'lstm': 0.20115065275514307}
2025-08-15 22:27:29,492 - stock_predictor - INFO - Ensemble built with weights: {'random_forest': 0.7988493472448569, 'lstm': 0.20115065275514307}
2025-08-15 22:27:29,492 - stock_predictor - INFO - Generating predictions for 7 future days
2025-08-15 22:27:29,566 - stock_predictor.evaluation.evaluator - INFO - Evaluation completed for ensemble: RMSE=54.2479, MAE=51.4600, Dir_Acc=52.17%
2025-08-15 22:27:29,566 - stock_predictor - INFO - Ensemble performance: RMSE=54.2479, MAE=51.4600, Directional Accuracy=52.17%
2025-08-15 22:27:29,566 - stock_predictor - INFO - Full pipeline completed successfully
