2025-08-12 10:21:30,670 - stock_predictor - INFO - Logging initialized. Log file: logs/stock_predictor_20250812_102130.log
2025-08-12 10:21:30,672 - stock_predictor.models.hyperparameters - INFO - Hyperparameters loaded for arima
2025-08-12 10:21:30,674 - stock_predictor.models.hyperparameters - INFO - Hyperparameters loaded for lstm
2025-08-12 10:21:30,675 - stock_predictor.models.hyperparameters - INFO - Hyperparameters loaded for random_forest
2025-08-12 10:21:30,675 - stock_predictor - INFO - Stock Predictor Application initialized
2025-08-12 10:21:30,675 - stock_predictor - INFO - Starting full pipeline for AAPL
2025-08-12 10:21:30,675 - stock_predictor - INFO - Fetching data for AAPL
2025-08-12 10:21:30,676 - stock_predictor.data.fetcher - INFO - Fetching data for AAPL from 2022-08-13 to 2025-08-12
2025-08-12 10:21:31,218 - stock_predictor.data.fetcher - INFO - Successfully fetched 750 records for AAPL
2025-08-12 10:21:31,218 - stock_predictor - INFO - Preprocessing data
2025-08-12 10:21:31,218 - stock_predictor.data.preprocessor - INFO - Handling missing values
2025-08-12 10:21:31,220 - stock_predictor.data.preprocessor - INFO - Handling outliers using method: cap
2025-08-12 10:21:31,221 - stock_predictor - INFO - Engineering features
2025-08-12 10:21:31,221 - stock_predictor.data.feature_engineer - INFO - Engineering all features
2025-08-12 10:21:31,221 - stock_predictor.data.feature_engineer - INFO - Creating moving averages with windows: [5, 10, 20, 50]
2025-08-12 10:21:31,223 - stock_predictor.data.feature_engineer - INFO - Calculating volatility with window: 20
2025-08-12 10:21:31,224 - stock_predictor.data.feature_engineer - INFO - Creating lagged features with lags: [1, 2, 3, 5]
2025-08-12 10:21:31,227 - stock_predictor.data.feature_engineer - INFO - Creating technical indicators
2025-08-12 10:21:31,232 - stock_predictor.data.feature_engineer - INFO - Created 42 features
2025-08-12 10:21:31,232 - stock_predictor.data.feature_engineer - INFO - Creating target variable: next_close, horizon: 1
2025-08-12 10:21:31,234 - stock_predictor - INFO - Data preparation completed. Final dataset: 700 samples, 52 features
2025-08-12 10:21:31,234 - stock_predictor - INFO - Data splits - Train: 489, Val: 106, Test: 105
2025-08-12 10:21:31,235 - stock_predictor - INFO - Starting model training
2025-08-12 10:21:31,235 - stock_predictor - INFO - Training arima model
2025-08-12 10:21:31,235 - stock_predictor.models.hyperparameters - INFO - Hyperparameters saved for arima
2025-08-12 10:21:31,236 - stock_predictor.models.arima - INFO - Updated hyperparameters for arima
2025-08-12 10:21:31,236 - stock_predictor.models.arima - INFO - Starting training for arima
2025-08-12 10:21:31,236 - stock_predictor.models.arima - INFO - Auto-selecting ARIMA order...
2025-08-12 10:21:31,236 - stock_predictor.models.arima - INFO - Starting auto ARIMA order selection
2025-08-12 10:21:32,677 - stock_predictor.models.arima - INFO - Best ARIMA order: (0, 1, 0), seasonal: None, AIC: 2347.39
2025-08-12 10:21:32,678 - stock_predictor.models.arima - ERROR - Training failed for arima: ARIMA model fitting failed: 'NoneType' object is not subscriptable
2025-08-12 10:21:32,678 - stock_predictor - ERROR - Failed to train arima: Training failed for arima: ARIMA model fitting failed: 'NoneType' object is not subscriptable
2025-08-12 10:21:32,678 - stock_predictor - INFO - Training lstm model
2025-08-12 10:21:32,679 - stock_predictor.models.hyperparameters - INFO - Hyperparameters saved for lstm
2025-08-12 10:21:32,679 - stock_predictor.models.lstm - INFO - Updated hyperparameters for lstm
2025-08-12 10:21:32,679 - stock_predictor.models.lstm - INFO - Starting training for lstm
2025-08-12 10:22:01,240 - stock_predictor.models.lstm - INFO - LSTM training completed. Final loss: 12571.065430
2025-08-12 10:22:01,240 - stock_predictor.models.lstm - INFO - Training completed for lstm in 28.56 seconds
2025-08-12 10:22:01,240 - stock_predictor - INFO - lstm training completed
2025-08-12 10:22:01,240 - stock_predictor - INFO - Training random_forest model
2025-08-12 10:22:01,241 - stock_predictor.models.hyperparameters - INFO - Hyperparameters saved for random_forest
2025-08-12 10:22:01,241 - stock_predictor.models.random_forest - INFO - Updated hyperparameters for random_forest
2025-08-12 10:22:01,242 - stock_predictor.models.random_forest - INFO - Starting training for random_forest
2025-08-12 10:22:01,399 - stock_predictor.models.random_forest - INFO - Random Forest training completed. Train RMSE: 1.583149
2025-08-12 10:22:01,399 - stock_predictor.models.random_forest - INFO - Validation RMSE: 14.824924
2025-08-12 10:22:01,399 - stock_predictor.models.random_forest - INFO - Training completed for random_forest in 0.16 seconds
2025-08-12 10:22:01,399 - stock_predictor - INFO - random_forest training completed
2025-08-12 10:22:01,399 - stock_predictor - INFO - Successfully trained 2 models
2025-08-12 10:22:01,399 - stock_predictor - INFO - Evaluating models
2025-08-12 10:22:01,722 - stock_predictor.evaluation.evaluator - ERROR - Model evaluation failed for lstm: Found input variables with inconsistent numbers of samples: [105, 46]
2025-08-12 10:22:01,722 - stock_predictor.evaluation.evaluator - WARNING - Failed to evaluate lstm: Model evaluation failed: Found input variables with inconsistent numbers of samples: [105, 46]
2025-08-12 10:22:01,741 - stock_predictor.evaluation.evaluator - INFO - Evaluation completed for random_forest: RMSE=8.8698, MAE=6.4277, Dir_Acc=54.81%
2025-08-12 10:22:01,742 - stock_predictor.evaluation.evaluator - INFO - Model comparison completed for 1 models
2025-08-12 10:22:01,742 - stock_predictor - INFO - Model evaluation results:
2025-08-12 10:22:01,746 - stock_predictor - INFO - 
        mae      rmse        mse  directional_accuracy      mape  r2_score  correlation  max_error      bias  n_samples     model_name
0  6.427674  8.869754  78.672541             54.807692  3.221341  0.092162     0.586421  33.298007  4.669783        105  random_forest
2025-08-12 10:22:01,746 - stock_predictor - INFO - Building ensemble
2025-08-12 10:22:01,746 - stock_predictor.ensemble.builder - INFO - Added model 'random_forest' to ensemble
2025-08-12 10:22:01,747 - stock_predictor.ensemble.builder - INFO - Calculated weights using inverse_error: {'random_forest': 1.0}
2025-08-12 10:22:01,747 - stock_predictor - INFO - Ensemble built with weights: {'random_forest': 1.0}
2025-08-12 10:22:01,747 - stock_predictor - INFO - Generating predictions for 7 future days
2025-08-12 10:22:01,766 - stock_predictor.evaluation.evaluator - INFO - Evaluation completed for ensemble: RMSE=8.8698, MAE=6.4277, Dir_Acc=54.81%
2025-08-12 10:22:01,766 - stock_predictor - INFO - Ensemble performance: RMSE=8.8698, MAE=6.4277, Directional Accuracy=54.81%
2025-08-12 10:22:01,767 - stock_predictor - INFO - Full pipeline completed successfully
