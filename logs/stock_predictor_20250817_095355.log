2025-08-17 09:53:55,068 - stock_predictor - INFO - Logging initialized. Log file: logs/stock_predictor_20250817_095355.log
2025-08-17 09:53:55,069 - stock_predictor.models.hyperparameters - INFO - Hyperparameters loaded for arima
2025-08-17 09:53:55,069 - stock_predictor.models.hyperparameters - INFO - Hyperparameters loaded for lstm
2025-08-17 09:53:55,070 - stock_predictor.models.hyperparameters - INFO - Hyperparameters loaded for random_forest
2025-08-17 09:53:55,070 - stock_predictor - INFO - Stock Predictor Application initialized
2025-08-17 09:53:55,070 - stock_predictor - INFO - Starting full pipeline for MSFT
2025-08-17 09:53:55,072 - stock_predictor - INFO - Fetching data for MSFT
2025-08-17 09:53:55,073 - stock_predictor.data.fetcher - INFO - Fetching data for MSFT from 2023-08-13 to 2025-08-12
2025-08-17 09:53:55,628 - stock_predictor.data.fetcher - INFO - Successfully fetched 500 records for MSFT
2025-08-17 09:53:55,629 - stock_predictor - INFO - Preprocessing data
2025-08-17 09:53:55,629 - stock_predictor.data.preprocessor - INFO - Handling missing values
2025-08-17 09:53:55,630 - stock_predictor.data.preprocessor - INFO - Handling outliers using method: cap
2025-08-17 09:53:55,632 - stock_predictor - INFO - Engineering features
2025-08-17 09:53:55,632 - stock_predictor.data.feature_engineer - INFO - Engineering all features
2025-08-17 09:53:55,632 - stock_predictor.data.feature_engineer - INFO - Creating moving averages with windows: [5, 10, 20]
2025-08-17 09:53:55,634 - stock_predictor.data.feature_engineer - INFO - Calculating volatility with window: 20
2025-08-17 09:53:55,635 - stock_predictor.data.feature_engineer - INFO - Creating lagged features with lags: [1, 2, 3]
2025-08-17 09:53:55,637 - stock_predictor.data.feature_engineer - INFO - Creating technical indicators
2025-08-17 09:53:55,643 - stock_predictor.data.feature_engineer - INFO - Created 36 features
2025-08-17 09:53:55,643 - stock_predictor.data.feature_engineer - INFO - Creating target variable: next_close, horizon: 1
2025-08-17 09:53:55,644 - stock_predictor - INFO - Data preparation completed. Final dataset: 479 samples, 46 features
2025-08-17 09:53:55,645 - stock_predictor - INFO - Data splits - Train: 335, Val: 72, Test: 72
2025-08-17 09:53:55,645 - stock_predictor - INFO - Starting model training
2025-08-17 09:53:55,645 - stock_predictor - INFO - Training arima model
2025-08-17 09:53:55,646 - stock_predictor.models.hyperparameters - INFO - Hyperparameters saved for arima
2025-08-17 09:53:55,646 - stock_predictor.models.arima - INFO - Updated hyperparameters for arima
2025-08-17 09:53:55,646 - stock_predictor.models.arima - INFO - Starting training for arima
2025-08-17 09:53:55,646 - stock_predictor.models.arima - INFO - Auto-selecting ARIMA order...
2025-08-17 09:53:55,647 - stock_predictor.models.arima - INFO - Starting auto ARIMA order selection
2025-08-17 09:53:56,493 - stock_predictor.models.arima - INFO - Best ARIMA order: (0, 1, 0), seasonal: None, AIC: 2032.07
2025-08-17 09:53:56,493 - stock_predictor.models.arima - ERROR - Training failed for arima: ARIMA model fitting failed: 'NoneType' object is not subscriptable
2025-08-17 09:53:56,494 - stock_predictor - ERROR - Failed to train arima: Training failed for arima: ARIMA model fitting failed: 'NoneType' object is not subscriptable
2025-08-17 09:53:56,494 - stock_predictor - INFO - Training lstm model
2025-08-17 09:53:56,494 - stock_predictor.models.hyperparameters - INFO - Hyperparameters saved for lstm
2025-08-17 09:53:56,495 - stock_predictor.models.lstm - INFO - Updated hyperparameters for lstm
2025-08-17 09:53:56,495 - stock_predictor.models.lstm - INFO - Starting training for lstm
2025-08-17 09:54:08,647 - stock_predictor.models.lstm - INFO - LSTM training completed. Final loss: 137331.687500
2025-08-17 09:54:08,647 - stock_predictor.models.lstm - INFO - Training completed for lstm in 12.15 seconds
2025-08-17 09:54:08,647 - stock_predictor - INFO - lstm training completed
2025-08-17 09:54:08,647 - stock_predictor - INFO - Training random_forest model
2025-08-17 09:54:08,648 - stock_predictor.models.hyperparameters - INFO - Hyperparameters saved for random_forest
2025-08-17 09:54:08,648 - stock_predictor.models.random_forest - INFO - Updated hyperparameters for random_forest
2025-08-17 09:54:08,649 - stock_predictor.models.random_forest - INFO - Starting training for random_forest
2025-08-17 09:54:08,775 - stock_predictor.models.random_forest - INFO - Random Forest training completed. Train RMSE: 3.136369
2025-08-17 09:54:08,775 - stock_predictor.models.random_forest - INFO - Validation RMSE: 12.099770
2025-08-17 09:54:08,775 - stock_predictor.models.random_forest - INFO - Training completed for random_forest in 0.13 seconds
2025-08-17 09:54:08,775 - stock_predictor - INFO - random_forest training completed
2025-08-17 09:54:08,775 - stock_predictor - INFO - Successfully trained 2 models
2025-08-17 09:54:08,776 - stock_predictor - INFO - Evaluating models
2025-08-17 09:54:09,115 - stock_predictor.evaluation.evaluator - INFO - Evaluation completed for lstm: RMSE=441.8823, MAE=440.7327, Dir_Acc=36.62%
2025-08-17 09:54:09,134 - stock_predictor.evaluation.evaluator - INFO - Evaluation completed for random_forest: RMSE=39.4489, MAE=32.4067, Dir_Acc=49.30%
2025-08-17 09:54:09,135 - stock_predictor.evaluation.evaluator - INFO - Model comparison completed for 2 models
2025-08-17 09:54:09,135 - stock_predictor - INFO - Model evaluation results:
2025-08-17 09:54:09,139 - stock_predictor - INFO - 
          mae        rmse            mse  directional_accuracy       mape    r2_score  correlation   max_error        bias  n_samples     model_name
1   32.406742   39.448937    1556.218666             49.295775   6.495754   -0.533668     0.767588   82.302559  -32.406742         72  random_forest
0  440.732685  441.882341  195260.003212             36.619718  91.735808 -191.430599          NaN  496.133591 -440.732685         72           lstm
2025-08-17 09:54:09,139 - stock_predictor - INFO - Building ensemble
2025-08-17 09:54:09,139 - stock_predictor.ensemble.builder - INFO - Added model 'random_forest' to ensemble
2025-08-17 09:54:09,140 - stock_predictor.ensemble.builder - INFO - Added model 'lstm' to ensemble
2025-08-17 09:54:09,140 - stock_predictor.ensemble.builder - INFO - Calculated weights using inverse_error: {'random_forest': 0.9017722278044309, 'lstm': 0.09822777219556907}
2025-08-17 09:54:09,140 - stock_predictor - INFO - Ensemble built with weights: {'random_forest': 0.9017722278044309, 'lstm': 0.09822777219556907}
2025-08-17 09:54:09,140 - stock_predictor - INFO - Generating predictions for 7 future days
2025-08-17 09:54:09,215 - stock_predictor.evaluation.evaluator - INFO - Evaluation completed for ensemble: RMSE=76.1220, MAE=72.5157, Dir_Acc=49.30%
2025-08-17 09:54:09,215 - stock_predictor - INFO - Ensemble performance: RMSE=76.1220, MAE=72.5157, Directional Accuracy=49.30%
2025-08-17 09:54:09,215 - stock_predictor - INFO - Full pipeline completed successfully
